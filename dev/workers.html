

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3. Notes regarding the RAMP workers &mdash; RAMP 0.1.0.dev0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="_static/js/copybutton.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/ramp.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Useful tips when running a RAMP" href="running_challenge.html" />
    <link rel="prev" title="2. Set up a new RAMP event" href="create_ramp_event.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> RAMP
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install and contribution</a></li>
</ul>
<p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="user_guide.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="setup_server.html">1. Set up your own server to run RAMP</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_ramp_event.html">2. Set up a new RAMP event</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3. Notes regarding the RAMP workers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running-a-submissions-on-amazon-web-services-aws">3.1. Running a submissions on Amazon Web Services (AWS)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="running_challenge.html">4. Useful tips when running a RAMP</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">RAMP API</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">RAMP Command-Line Interface</a></li>
</ul>
<p class="caption"><span class="caption-text">Addtional Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="whats_new.html">Release history</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About us</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">RAMP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="user_guide.html">User Guide</a> &raquo;</li>
        
      <li>3. Notes regarding the RAMP workers</li>
    
    

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="notes-regarding-the-ramp-workers">
<h1>3. Notes regarding the RAMP workers<a class="headerlink" href="#notes-regarding-the-ramp-workers" title="Permalink to this headline">¶</a></h1>
<p>The RAMP “worker” is the object responsible of actually running (training and
evaluating) a submission and returning back the results (predictions and
scores).
The workers are typically launched from a loop set up for a specific event on
the server. The worker can then run the submission either locally on the server
or on a remote machine.</p>
<p>The type of worker used in a certain event is specified in the <code class="docutils literal notranslate"><span class="pre">worker</span></code>
section of the yml configuration file, using the <code class="docutils literal notranslate"><span class="pre">worker_type</span></code> key (see
<a class="reference internal" href="create_ramp_event.html#deploy-ramp-event"><span class="std std-ref">Deploy a specific RAMP event</span></a>). Additional keys can be required depending on
the worker type.</p>
<p>Available workers:</p>
<ul class="simple">
<li>The <a class="reference internal" href="generated/ramp_engine.local.CondaEnvWorker.html#ramp_engine.local.CondaEnvWorker" title="ramp_engine.local.CondaEnvWorker"><code class="xref py py-class docutils literal notranslate"><span class="pre">ramp_engine.local.CondaEnvWorker</span></code></a> will run the submission in
a specific isolated conda environment. This worker is specified as
<code class="docutils literal notranslate"><span class="pre">worker_type:</span> <span class="pre">conda</span></code> and requires an additional key <code class="docutils literal notranslate"><span class="pre">conda_env</span></code>
specifying the name of the conda environment.</li>
<li>The <a class="reference internal" href="generated/ramp_engine.aws.AWSWorker.html#ramp_engine.aws.AWSWorker" title="ramp_engine.aws.AWSWorker"><code class="xref py py-class docutils literal notranslate"><span class="pre">ramp_engine.aws.AWSWorker</span></code></a> will send the submission to an AWS
instance and copy back the results. This worker is specified as
<code class="docutils literal notranslate"><span class="pre">worker_type:</span> <span class="pre">aws</span></code>, and for more details on the setup and configuration,
see below.</li>
</ul>
<div class="section" id="running-a-submissions-on-amazon-web-services-aws">
<h2>3.1. Running a submissions on Amazon Web Services (AWS)<a class="headerlink" href="#running-a-submissions-on-amazon-web-services-aws" title="Permalink to this headline">¶</a></h2>
<p>The AWS worker will train and evaluate the submissions on an AWS instance,
which can be useful if the server itself has not much resources or if you need
specific resources (e.g. GPU’s).</p>
<p>You need to create an Amazon Machine Image (AMI) with the starting kit and
data, and the needed packages to run submissions. This AMI will then be used
to launch instances to run submissions.</p>
<p>A very short how-to for creating such an AMI manually:</p>
<ul>
<li><p class="first">launch an Amazon instance</p>
</li>
<li><p class="first">connect to it</p>
</li>
<li><p class="first">prepare the instance:</p>
<ul>
<li><p class="first">Install miniconda:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LATEST_MINICONDA=&quot;http://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh&quot;
wget -q $LATEST_MINICONDA -O ~/miniconda.sh
bash ~/miniconda.sh -b
echo &#39;. ${HOME}/miniconda3/etc/profile.d/conda.sh&#39; &gt;&gt; ~/.profile
echo &#39;conda activate base&#39; &gt;&gt; ~/.profile
source .profile
conda info
conda update --yes --quiet conda pip
</pre></div>
</div>
</li>
<li><p class="first">Get the starting kit material (example here for Iris):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>RAMPKIT_DIR=&quot;$HOME/ramp-kits&quot;
project_name=&quot;iris&quot;
kit_url=&quot;https://github.com/ramp-kits/$project_name&quot;
kit_dir=&quot;$RAMPKIT_DIR/$project_name&quot;
git clone $kit_url $kit_dir
</pre></div>
</div>
</li>
<li><p class="first">Update the base conda environment for the needs of the challenge:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ami_environment=&quot;$kit_dir/ami_environment.yml&quot;
conda env update --name base --file $ami_environment
conda list
</pre></div>
</div>
</li>
<li><p class="first">Get the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>data_dir=&quot;$kit_dir/data&quot;
rm -rf $data_dir &amp;&amp; mkdir $data_dir
git clone https://github.com/ramp-data/iris ramp-data/iris
cd ramp-data/iris/
python prepare_data.py
cd ..
</pre></div>
</div>
<p>TODO: figure out this data (in ramp-kits/data or in ramp-data?)</p>
</li>
<li><p class="first">Test the kit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">ramp</span><span class="o">-</span><span class="n">kits</span><span class="o">/</span><span class="n">iris</span>
<span class="n">ramp</span><span class="o">-</span><span class="n">test</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Save the instance as an AMI: from the instance -&gt; Actions -&gt; Image -&gt; Create image</p>
</li>
<li><p class="first">Create an event config.yml, which should look something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ramp</span><span class="p">:</span>
    <span class="n">problem_name</span><span class="p">:</span> <span class="n">iris</span>
    <span class="n">event_name</span><span class="p">:</span> <span class="n">iris_ramp_aws_test</span>
    <span class="n">event_title</span><span class="p">:</span> <span class="n">iris_ramp_aws_test</span>
    <span class="n">event_is_public</span><span class="p">:</span> <span class="n">true</span>
    <span class="o">...</span>
<span class="n">worker</span><span class="p">:</span>
    <span class="n">worker_type</span><span class="p">:</span> <span class="n">aws</span>
    <span class="n">access_key_id</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">aws_access_key_id</span> <span class="k">for</span> <span class="n">boto3</span> <span class="n">Session</span><span class="o">&gt;</span>
    <span class="n">secret_access_key</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">aws_secret_access_key</span> <span class="k">for</span> <span class="n">boto3</span> <span class="n">Session</span><span class="o">&gt;</span>
    <span class="n">region_name</span><span class="p">:</span> <span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">2</span> <span class="c1"># oregon</span>
    <span class="n">ami_image_name</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">AMI</span> <span class="nb">set</span> <span class="n">up</span> <span class="k">for</span> <span class="n">this</span> <span class="n">event</span><span class="o">&gt;</span>
    <span class="n">ami_user_name</span> <span class="p">:</span> <span class="n">ubuntu</span>
    <span class="n">instance_type</span> <span class="p">:</span> <span class="n">t2</span><span class="o">.</span><span class="n">micro</span>
    <span class="n">key_name</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">user</span> <span class="n">that</span> <span class="n">can</span> <span class="n">ssh</span> <span class="n">connect</span> <span class="k">with</span> <span class="n">the</span> <span class="n">created</span> <span class="n">AWS</span> <span class="n">instance</span><span class="o">&gt;</span>
    <span class="n">security_group</span> <span class="p">:</span> <span class="n">launch</span><span class="o">-</span><span class="n">wizard</span><span class="o">-</span><span class="mi">103</span>
    <span class="n">key_path</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">pem</span> <span class="n">file</span> <span class="n">corresponding</span> <span class="n">to</span> <span class="n">user</span> <span class="n">name</span><span class="o">&gt;</span>
    <span class="n">remote_ramp_kit_folder</span> <span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">ramp</span><span class="o">-</span><span class="n">kits</span><span class="o">/</span><span class="n">iris</span>
    <span class="n">memory_profiling</span> <span class="p">:</span> <span class="n">false</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="running_challenge.html" class="btn btn-neutral float-right" title="4. Useful tips when running a RAMP" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="create_ramp_event.html" class="btn btn-neutral float-left" title="2. Set up a new RAMP event" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015 - 2019, Paris-Saclay Center for Data Science

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>